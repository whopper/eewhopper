version: 1.3.0

variables:
  global:
    COMPOSER_BIN: $SOURCE_DIR/vendor/bin
    BLT_DIR: $SOURCE_DIR/vendor/acquia/blt

cde-databases:
  - testdb1
  - testmigratedb1

events:
  build:
    steps:
      - setup-env:
          type: script
          script:
            - composer require acquia/blt:^10.0 --no-update
            - composer update
            - ./vendor/bin/blt setup
            # Update gitignore: https://docs.acquia.com/blt/install/adding-to-project/
            #- composer create-project --no-interaction acquia/blt-project migration
            #- mv migration/* .
            #- blt setup

  post-deploy:
    steps:
      - deploy:
          script:
            - pipelines-deploy
